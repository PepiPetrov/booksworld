{"version":3,"sources":["services/search-service.js","services/profile-service.js","validators.js","components/books/details/Details.module.css","components/books/comments/Comments.js","components/books/details/Details.js"],"names":["searchByTitle","string","a","getAll","books","results","book","title","toLowerCase","includes","push","sort","b","localeCompare","searchByAuthor","author","searchByGenre","genres","map","x","filter","length","searchBySeries","series","seriesRow","db","getDatabase","app","dbRef","ref","getUserFavourites","get","child","userKey","snapshot","users","val","favourites","_id","localStorage","getItem","user","userId","id","getBook","undefined","splice","indexOf","set","getCreatedBooks","created","creator","getLikedBooks","liked","likes","setUserPreferences","authors","preferences","getUserPreferences","getRecommendedBooks","allBooks","recommendedBooks","genre","Set","Array","from","removeProfile","usersSnap","getAllComments","comments","removeBook","edit","removeAllCommentsForBook","comment","removeComment","remove","isEmpty","equals","isLength","isURL","url","test","isEmail","email","module","exports","CommentItem","setComments","bookId","useState","showEdit","setShowEdit","style","width","marginLeft","marginTop","color","marginBottom","content","Button","variant","onClick","e","confirm","then","getCommentsByBook","EditForm","form","setForm","errors","setErrors","findFormErrors","newErrors","Form","onSubmit","preventDefault","Object","keys","editComment","Group","Label","Control","placeholder","defaultValue","onChange","field","value","target","isInvalid","type","Comments","isLoading","setIsLoading","contentRef","createRef","useEffect","className","current","createComment","as","Feedback","Details","useSelector","state","login","useContext","AuthContext","setBook","showDislike","setShowDislike","ratings","setRatings","setUrl","isImgLoading","setIsImgLoading","isRemoving","setIsRemoving","useParams","join","username","sum","item","Number","rating","getImageUrl","styles","to","Image","src","alt","wordBreak","description","publisher","year","href","buyLink","downloadLink","onlineLink","Favourites","Rating","window","location","pathname","onRemoveBtnClick","like","reload","onLike","dislike","Modal","show","backdrop","keyboard","Body","setRating","addRating","max","min","setFavourites","removeFromFavourites","addToFavourites"],"mappings":"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","file":"static/js/24.050860b7.chunk.js","sourcesContent":["import { getAll } from './books-service'\r\n\r\nexport async function searchByTitle(string) {\r\n    const books = await getAll()\r\n    const results = []\r\n    if (books !== null) {\r\n        for (const book of books) {\r\n            if (book.title.toLowerCase().includes(string.toLowerCase())) {\r\n                results.push(book)\r\n            }\r\n        }\r\n        results.sort((a, b) => a.title.localeCompare(b.title))\r\n    }\r\n    return results\r\n}\r\n\r\nexport async function searchByAuthor(string) {\r\n    const books = await getAll()\r\n    const results = []\r\n    if (books !== null) {\r\n        for (const book of books) {\r\n            if (book.author.toLowerCase().includes(string.toLowerCase())) {\r\n                results.push(book)\r\n            }\r\n        }\r\n        results.sort((a, b) => a.title.localeCompare(b.title))\r\n    }\r\n    return results\r\n}\r\n\r\nexport async function searchByGenre(string) {\r\n    const books = await getAll()\r\n    const results = []\r\n    if (books !== null) {\r\n        for (const book of books) {\r\n            const genres = book.genres.map(x => x.toLowerCase())\r\n            if (genres.filter(x => x.includes(string.toLowerCase())).length > 0) {\r\n                results.push(book)\r\n            }\r\n        }\r\n        results.sort((a, b) => a.title.localeCompare(b.title))\r\n    }\r\n    return results\r\n}\r\n\r\nexport async function searchBySeries(string) {\r\n    const books = await getAll()\r\n    const results = []\r\n    if (books !== null) {\r\n        for (const book of books) {\r\n            if (book.series && book.series.toLowerCase().includes(string.toLowerCase())) {\r\n                results.push(book)\r\n            }\r\n        }\r\n        results.sort((a, b) => a.seriesRow - b.seriesRow)\r\n    }\r\n    return results\r\n}","import { getDatabase, ref, child, get, set, remove } from \"firebase/database\"\r\nimport app from './firebase'\r\nimport { getAll, getBook, removeBook, edit } from './books-service'\r\nimport { searchByGenre,searchByAuthor } from './search-service'\r\nimport { getAllComments, removeAllCommentsForBook, removeComment } from \"./comments-service\"\r\n\r\nconst db = getDatabase(app)\r\nconst dbRef = ref(db)\r\n\r\nexport async function getUserFavourites() {\r\n    const snapshot = await get(child(dbRef, '/users'))\r\n    const users = snapshot.val()\r\n    let userId\r\n    let favourites = []\r\n    for (let userKey in users) {\r\n        if (users[userKey]._id === localStorage.getItem('token')) {\r\n            const user = users[userKey]\r\n            userId = userKey\r\n            if (user.favourites) {\r\n                favourites = user.favourites\r\n            }\r\n        }\r\n    }\r\n    for (let id of favourites) {\r\n        const book = await getBook(id)\r\n        if (book === undefined) {\r\n            favourites.splice(favourites.indexOf(id), 1)\r\n        }\r\n        const user = users[userId]\r\n        user.favourites = favourites\r\n        await set(child(dbRef, '/users/' + userId), user)\r\n    }\r\n    return favourites\r\n}\r\n\r\nexport async function getCreatedBooks() {\r\n    const books = await getAll()\r\n    let created = []\r\n    if (books !== null) {\r\n        for (let book of books) {\r\n            if (book.creator === localStorage.getItem('username')) {\r\n                created.push(book)\r\n            }\r\n        }\r\n    }\r\n    return created\r\n}\r\n\r\nexport async function getLikedBooks() {\r\n    const books = await getAll()\r\n    let liked = []\r\n    if (books !== null) {\r\n        for (let book of books) {\r\n            if (book.likes !== undefined && book.likes.includes(localStorage.getItem('username'))) {\r\n                liked.push(book)\r\n            }\r\n        }\r\n    }\r\n    return liked\r\n}\r\n\r\nexport async function setUserPreferences({ authors, genres }) {\r\n    const snapshot = await get(child(dbRef, '/users'))\r\n    const users = snapshot.val()\r\n    for (let userKey in users) {\r\n        if (users[userKey]._id === localStorage.getItem('token')) {\r\n            const user = users[userKey]\r\n            user.preferences = { authors, genres }\r\n            await set(child(dbRef, '/users/' + userKey), user)\r\n        }\r\n    }\r\n}\r\n\r\nexport async function getUserPreferences() {\r\n    const snapshot = await get(child(dbRef, '/users'))\r\n    const users = snapshot.val()\r\n    let preferences = {}\r\n    for (let userKey in users) {\r\n        if (users[userKey]._id === localStorage.getItem('token')) {\r\n            const user = users[userKey]\r\n            if (user.preferences) {\r\n                preferences = user.preferences\r\n            } else {\r\n                preferences = { authors: [], genres: [] }\r\n            }\r\n        }\r\n    }\r\n    return preferences\r\n}\r\n\r\nexport async function getRecommendedBooks() {\r\n    const { genres, authors } = await getUserPreferences()\r\n    const allBooks = await getAll()\r\n    const recommendedBooks = []\r\n\r\n    if (allBooks !== null) {\r\n        if (genres && genres.length > 0) {\r\n            for (let genre of genres) {\r\n                const filteredBooks = await searchByGenre(genre)\r\n                filteredBooks.map(x => {\r\n                    recommendedBooks.push(x)\r\n                    return x\r\n                })\r\n            }\r\n        }\r\n        if (authors && authors.length > 0) {\r\n            for (let author of authors) {\r\n                const filteredBooks = await searchByAuthor(author)\r\n                filteredBooks.map(x => {\r\n                    recommendedBooks.push(x)\r\n                    return x\r\n                })\r\n            }\r\n        }\r\n    }\r\n    const set = new Set(recommendedBooks)\r\n    return Array.from(set)\r\n}\r\n\r\nexport async function removeProfile() {\r\n    const books = await getAll()\r\n    const usersSnap = await get(dbRef, '/users')\r\n    const users = usersSnap.val()\r\n    const comments = await getAllComments()\r\n    for (const book of books) {\r\n        if (book.creator === localStorage.getItem('username')) {\r\n            await removeBook(book._id)\r\n        }\r\n        if (book.likes && book.likes.includes(localStorage.getItem('username'))) {\r\n            book.likes.splice(book.likes.indexOf(localStorage.getItem('username')), 1)\r\n            await edit(book._id, book)\r\n        }\r\n        await removeAllCommentsForBook(book._id)\r\n    }\r\n\r\n    for (const comment of comments) {\r\n        if (comment.creator === localStorage.getItem('username')) {\r\n            await removeComment(comment._id)\r\n        }\r\n    }\r\n\r\n    for (const userId in users) {\r\n        const user = users[userId]\r\n        if (user._id === localStorage.getItem('token')) {\r\n            await remove(child(dbRef, '/users/' + userId))\r\n        }\r\n    }\r\n\r\n}","export function isEmpty(string) {\r\n    if (string.length === 0 || string === undefined) {\r\n        return true\r\n    }\r\n    return false\r\n}\r\n\r\nexport function equals(a, b) {\r\n    if (a === b) {\r\n        return true\r\n    }\r\n    return false\r\n}\r\n\r\nexport function isLength(string, length) {\r\n    if (string.length >= length) {\r\n        return true\r\n    }\r\n    return false\r\n}\r\n\r\nexport function isURL(url) {\r\n    const regex = /^(https:|http:|www\\.)\\S*/gm\r\n    return regex.test(url)\r\n}\r\n\r\nexport function isEmail(email) {\r\n    const regex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$/\r\n    return regex.test(email)\r\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"grey-text\":\"Details_grey-text__2TyhD\"};","import { createRef, useState } from 'react'\r\nimport { useEffect } from 'react'\r\nimport Form from 'react-bootstrap/Form'\r\nimport Button from 'react-bootstrap/Button'\r\nimport { confirm } from 'react-bootstrap-confirmation'\r\nimport { getCommentsByBook, createComment, editComment, removeComment } from '../../../services/comments-service'\r\n\r\nfunction Comments({ bookId }) {\r\n    const [comments, setComments] = useState([])\r\n    const [isLoading, setIsLoading] = useState(true)\r\n    const [form, setForm] = useState({})\r\n    const [errors, setErrors] = useState({})\r\n    const contentRef = createRef()\r\n\r\n    useEffect(() => {\r\n        if (isLoading) {\r\n            getCommentsByBook(bookId).then(x => {\r\n                setComments(x)\r\n            })\r\n        }\r\n\r\n        return () => {\r\n            setIsLoading(false)\r\n        }\r\n    }, [isLoading, bookId])\r\n\r\n    const setField = (field, value) => {\r\n        setForm({\r\n            ...form,\r\n            [field]: value\r\n        })\r\n        if (!!errors[field]) setErrors({\r\n            ...errors,\r\n            [field]: null\r\n        })\r\n    }\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault()\r\n        const newErrors = findFormErrors()\r\n        if (Object.keys(newErrors).length > 0) {\r\n            setErrors(newErrors)\r\n            return\r\n        }\r\n        contentRef.current.value = \"\"\r\n        createComment(form, bookId).then(x => {\r\n            setComments(x)\r\n        })\r\n    }\r\n\r\n    const findFormErrors = () => {\r\n        const newErrors = {}\r\n        const { content } = form\r\n        if (content === undefined && content.length === 0) {\r\n            newErrors.content = 'Content is required!'\r\n        }\r\n        return newErrors\r\n    }\r\n\r\n    return <div className=\"align-items-center\" style={{ marginTop: \"1%\" }}>\r\n        {comments.length > 0\r\n            ? comments.map(x => <CommentItem comment={x} setComments={setComments} bookId={bookId} key={x._id}></CommentItem>)\r\n            : <p>No comments</p>}\r\n        {localStorage.getItem('token')\r\n            ? <Form onSubmit={handleSubmit} style={{ marginTop: \"0.5%\", width: \"50%\", marginLeft: \"26%\" }}>\r\n                <Form.Group>\r\n                    <Form.Control ref={contentRef} as=\"textarea\" onChange={e => setField('content', e.target.value)} placeholder=\"Comment\" isInvalid={!!errors.content}></Form.Control>\r\n                    <Form.Control.Feedback type=\"invalid\">{errors.content}</Form.Control.Feedback>\r\n                </Form.Group>\r\n                <Button type=\"submit\" variant=\"success\" style={{ marginTop: \"3%\", marginBottom: \"2%\" }}>Write comment</Button>\r\n            </Form>\r\n            : null}\r\n    </div>\r\n}\r\n\r\nfunction CommentItem({ comment, setComments, bookId }) {\r\n    const [showEdit, setShowEdit] = useState(false)\r\n    const remove = () => {\r\n        confirm('Arey you sure you want to remove the comment?').then(x => {\r\n            if (x) {\r\n                removeComment(comment._id).then(x => {\r\n                    getCommentsByBook(bookId).then(x => {\r\n                        setComments(x)\r\n                    })\r\n                })\r\n            }\r\n        })\r\n    }\r\n    return <div>\r\n        <div style={{ width: \"90%\", marginLeft: \"6%\", marginTop: \"2%\" }}><p style={{ color: \"#198754\", marginBottom: \"0\" }}>{comment.creator} says:</p> {comment.content}</div>\r\n        {comment.creator === localStorage.getItem('username')\r\n            ? <div style={{ marginBottom: \"2%\" }}>\r\n                {!showEdit\r\n                    ? <Button variant=\"warning\" onClick={e => setShowEdit(true)} style={{ marginTop: \"2%\" }}>Show edit</Button>\r\n                    : <Button variant=\"warning\" onClick={e => setShowEdit(false)}  style={{ marginTop: \"2%\" }}>Hide edit</Button>\r\n                }\r\n                {'  '}\r\n                <Button variant=\"danger\" onClick={remove} style={{ marginTop: \"2%\" }}>Remove comment</Button>\r\n                {showEdit\r\n                    ? <EditForm comment={comment} setComments={setComments} bookId={bookId} setShowEdit={setShowEdit}></EditForm>\r\n                    : null}\r\n            </div>\r\n            : null}\r\n    </div>\r\n}\r\n\r\nfunction EditForm({ setComments, bookId, comment, setShowEdit }) {\r\n    const [form, setForm] = useState({ content: comment.content })\r\n    const [errors, setErrors] = useState({})\r\n\r\n    const setField = (field, value) => {\r\n        setForm({\r\n            ...form,\r\n            [field]: value\r\n        })\r\n        if (!!errors[field]) setErrors({\r\n            ...errors,\r\n            [field]: null\r\n        })\r\n    }\r\n\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault()\r\n        const newErrors = findFormErrors()\r\n        if (Object.keys(newErrors).length > 0) {\r\n            setErrors(newErrors)\r\n            return\r\n        }\r\n        editComment(form, comment._id).then(x => {\r\n            getCommentsByBook(bookId).then(x => {\r\n                setComments(x)\r\n                setShowEdit(false)\r\n            })\r\n        })\r\n    }\r\n\r\n    const findFormErrors = () => {\r\n        const newErrors = {}\r\n        const { content } = form\r\n        if (content === undefined || content.length === 0) {\r\n            newErrors.content = 'Content is required!'\r\n        }\r\n        return newErrors\r\n    }\r\n\r\n    return <Form style={{ marginTop: \"2%\" }} onSubmit={handleSubmit}>\r\n        <Form.Group>\r\n            <Form.Label>Comment content</Form.Label>\r\n            <Form.Control style={{ width: \"80%\", marginLeft: \"10%\" }} placeholder=\"Content\" defaultValue={comment.content}\r\n                onChange={e => setField('content', e.target.value)}\r\n                isInvalid={!!errors.content}></Form.Control>\r\n        </Form.Group>\r\n        <Button type=\"submit\" style={{ marginTop: \"2%\", marginBottom: \"2%\" }}>Edit comment</Button>\r\n    </Form>\r\n}\r\n\r\nexport default Comments","import { useContext, useEffect, useState } from \"react\"\r\nimport Button from \"react-bootstrap/Button\"\r\nimport Image from \"react-bootstrap/Image\"\r\nimport Form from 'react-bootstrap/Form'\r\nimport Modal from 'react-bootstrap/Modal'\r\nimport { useParams } from \"react-router\"\r\nimport { Link } from 'react-router-dom'\r\nimport { useSelector } from \"react-redux\"\r\nimport { confirm } from 'react-bootstrap-confirmation'\r\n\r\nimport { getBook, removeBook, like, dislike, addRating, addToFavourites, removeFromFavourites } from \"../../../services/books-service\"\r\nimport { getUserFavourites } from \"../../../services/profile-service\"\r\nimport { getImageUrl } from \"../../../services/image-service\"\r\nimport { isURL } from '../../../validators'\r\nimport AuthContext from '../../../contexts/AuthContext'\r\nimport styles from './Details.module.css'\r\nimport Comments from \"../comments/Comments\"\r\n\r\nexport default function Details() {\r\n    const user = useSelector(state => state.user)\r\n    const { login } = useContext(AuthContext)\r\n    const [book, setBook] = useState({})\r\n    const [showDislike, setShowDislike] = useState(false)\r\n    const [ratings, setRatings] = useState(0)\r\n    const [isLoading, setIsLoading] = useState(true)\r\n    const [url, setUrl] = useState('')\r\n    const [isImgLoading, setIsImgLoading] = useState(true)\r\n    const [isRemoving, setIsRemoving] = useState(false)\r\n    const { id } = useParams()\r\n    useEffect(() => {\r\n        if (isLoading) {\r\n            getBook(id).then(x => {\r\n                if (x.genres) {\r\n                    x.genres = x.genres.join(', ')\r\n                }\r\n                if (x.likes !== undefined && x.likes.includes(user.username)) {\r\n                    setShowDislike(true)\r\n                }\r\n                if (x.ratings !== undefined) {\r\n                    let sum = 0\r\n                    for (let item of x.ratings) {\r\n                        sum += Number(item.rating)\r\n                    }\r\n                    setRatings(sum / x.ratings.length)\r\n\r\n                }\r\n\r\n\r\n                setBook(x)\r\n\r\n                return x\r\n            }).then(x => {\r\n                getImageUrl(x._id).then(url => {\r\n                    setUrl(url)\r\n                    setIsImgLoading(false)\r\n                })\r\n            })\r\n\r\n        }\r\n\r\n\r\n        return () => {\r\n            setIsLoading(false)\r\n        }\r\n    }, [id, user, isLoading])\r\n\r\n\r\n    return <div className={`text-center ${styles['grey-text']}`} style={{ marginTop: \"1%\" }}>\r\n        <p>Title: {book.title}</p>\r\n        <p>Author: {book.author}</p>\r\n        <p>Created by <Link to={`/user/${book.creator}`} style={{ color: \"#157347\" }}>{book.creator}</Link></p>\r\n        {isImgLoading\r\n            ? <p>Image is loading ... Please wait</p>\r\n            : <Image src={url} alt=\"No image\" style={{ width: \"40%\" }} />}\r\n        <div style={{ marginTop: \"1%\" }}>\r\n            <p style={{ marginBottom: \"0.1%\" }}>Description: </p>\r\n            <p style={{ wordBreak: 'break-all', width: \"50%\", marginLeft: \"25%\" }}>{book.description}</p>\r\n        </div>\r\n        <p>Publisher: {book.publisher}</p>\r\n        <p>This book is published in {book.year}</p>\r\n        {book.series\r\n            // eslint-disable-next-line\r\n            ? <p>This is the {book.seriesRow}th book of the series <Button variant=\"success\" href={`/series/${book.series}`} variant=\"success\">{book.series}</Button></p>\r\n            : null}\r\n        {book.genres\r\n            ? <p>Genres: {book.genres}</p>\r\n            : <p>No selected genres</p>\r\n        }\r\n        {isURL(book.buyLink)\r\n            ? <p>You can buy the book here:<br></br> <Button variant=\"secondary\" href={book.buyLink} target=\"_blank\">{book.buyLink}</Button></p>\r\n            : <p >No buy link</p>\r\n        }\r\n        {isURL(book.downloadLink)\r\n            ? <p>You can download the book here:<br></br> <Button variant=\"secondary\" href={book.buyLink} target=\"_blank\">{book.downloadLink}</Button></p>\r\n            : <p>No download link</p>\r\n        }\r\n        {isURL(book.onlineLink)\r\n            ? <p>You can read the book here:<br></br> <Button variant=\"secondary\" href={book.buyLink} target=\"_blank\">{book.onlineLink}</Button></p>\r\n            : <p>No read online link</p>\r\n        }\r\n        <p style={{ marginTop: \"2%\" }}></p>\r\n        {book.ratings !== undefined\r\n            ? <p>Average rating: {ratings}</p>\r\n            : null}\r\n        {localStorage.getItem('token')\r\n            ? <Favourites bookId={book._id} />\r\n            : null\r\n        }\r\n        {localStorage.getItem('token')\r\n            ? <Rating book={book} />\r\n            : null\r\n        }\r\n        <br />\r\n        {user.username === book.creator ?\r\n            <div style={{ marginTop: \"0.5%\", marginBottom: \"2%\" }}>\r\n                <Button href={`/edit/${book._id}`} variant=\"warning\">Edit book</Button>\r\n                {'  '}\r\n                <Button onClick={e => onRemoveBtnClick(book._id, setIsRemoving)} variant=\"danger\">Remove book</Button>\r\n            </div>\r\n            : null\r\n        }\r\n\r\n        {\r\n            book.likes && book.likes.length > 0\r\n                ? <p>This book has {book.likes.length} like{book.likes.length > 1 ? 's' : ''}</p>\r\n                : null\r\n        }\r\n\r\n        {user.username !== book.creator &&\r\n            user.username !== null && showDislike === false ?\r\n            <Button onClick={e => onLike(book._id, login)} variant=\"success\" style={{ marginTop: \"0.5%\", marginBottom: \"2%\" }}>Like this book</Button>\r\n            : null\r\n        }\r\n        {showDislike ?\r\n            <Button onClick={e => onDislike(book._id)} variant=\"success\" style={{ marginTop: \"0.5%\", marginBottom: \"2%\" }}>Dislike this book</Button>\r\n            : null\r\n        }\r\n        <h4>Comments</h4>\r\n        <Comments bookId={id}></Comments>\r\n        <Modal\r\n            show={isRemoving}\r\n            backdrop=\"static\"\r\n            keyboard={false}\r\n        >\r\n            <Modal.Body>\r\n                Book is being removed...\r\n            </Modal.Body>\r\n        </Modal>\r\n    </div>\r\n}\r\n\r\nfunction onRemoveBtnClick(bookId, setIsRemoving) {\r\n    confirm('Are you sure you want to remove the book?').then(x => {\r\n        if (x) {\r\n            setIsRemoving(true)\r\n            removeBook(bookId).then(x => {\r\n                setIsRemoving(false)\r\n                window.location.pathname = \"/books/all\"\r\n            })\r\n        }\r\n    })\r\n}\r\n\r\nfunction onLike(bookId, login) {\r\n    like(bookId, login).then(() => {\r\n        window.location.reload()\r\n    })\r\n}\r\n\r\nfunction onDislike(bookId) {\r\n    confirm('Are you sure you want to dislike the book?').then(x => {\r\n        if (x) {\r\n            dislike(bookId).then(() => {\r\n                window.location.reload()\r\n            })\r\n        }\r\n    })\r\n}\r\n\r\nfunction Rating({ book }) {\r\n    const [rating, setRating] = useState(1)\r\n    const onSubmit = (e) => {\r\n        e.preventDefault()\r\n        addRating(book._id, rating).then(() => {\r\n            window.location.reload()\r\n        })\r\n    }\r\n    if (book.ratings !== undefined && book.ratings.filter(x => x.username === localStorage.getItem('username')).length === 0) {\r\n        return <Form onSubmit={onSubmit} style={{ marginTop: \"1%\", width: \"50%\", marginLeft: \"25%\" }}>\r\n            <Form.Label>Rating</Form.Label>\r\n            <Form.Control style={{ width: \"50%\", marginLeft: \"25%\" }} type=\"number\" max=\"10\" min=\"1\" onChange={e => setRating(e.target.value)}></Form.Control>\r\n            <Button type=\"submit\" variant=\"success\" style={{ marginTop: \"2%\" }}>Submit rating</Button>\r\n        </Form>\r\n    }\r\n    if (book.ratings === undefined) {\r\n        return <Form onSubmit={onSubmit} style={{ marginTop: \"1%\", width: \"50%\", marginLeft: \"24.9%\" }}>\r\n            <Form.Label>Rating</Form.Label>\r\n            <Form.Control style={{ width: \"50%\", marginLeft: \"25%\" }} type=\"number\" max=\"10\" min=\"1\" onChange={e => setRating(e.target.value)}></Form.Control>\r\n            <Button type=\"submit\" variant=\"success\" style={{ marginTop: \"2%\" }}>Submit rating</Button>\r\n        </Form>\r\n    }\r\n    return null\r\n}\r\n\r\nfunction Favourites({ bookId }) {\r\n    const [favourites, setFavourites] = useState([])\r\n    const [isLoading, setIsLoading] = useState(true)\r\n    useEffect(() => {\r\n        if (isLoading) {\r\n            getUserFavourites().then(x => {\r\n                setFavourites(x)\r\n            })\r\n        }\r\n\r\n        return () => {\r\n            setIsLoading(false)\r\n        }\r\n    }, [isLoading])\r\n\r\n    const addToFavouritesBtnClick = () => {\r\n        addToFavourites(bookId).then(() => {\r\n            window.location.reload()\r\n        })\r\n    }\r\n    const removeFromFavouritesBtnClick = () => {\r\n        removeFromFavourites(bookId).then(x => {\r\n            window.location.reload()\r\n        })\r\n    }\r\n    if (favourites === [] || !favourites.includes(bookId)) {\r\n        return <Button onClick={addToFavouritesBtnClick} variant=\"success\" style={{ marginBottom: \"2%\" }}>Add this book to your favourite books</Button>\r\n    } else {\r\n        return <Button onClick={removeFromFavouritesBtnClick} variant=\"success\" style={{ marginBottom: \"2%\" }}>Remove this book from your favourite books</Button>\r\n    }\r\n}"],"sourceRoot":""}