{"version":3,"sources":["components/books/utils/BooksList/BookItem/BookItem.module.css","components/books/utils/BooksList/BooksList.module.css","hooks/usePaginate.js","components/books/utils/Pagination/paginate.js","components/books/utils/Pagination/Pagination.js","components/books/utils/BooksList/BookItem/BookItem.js","components/books/utils/BooksList/BooksList.js","components/util/splitArray.js","services/search-service.js","hoc/isAuth.js","services/profile-service.js","components/books/profile-components/favourite/FavouriteBooks.js"],"names":["module","exports","usePaginate","books","useState","currentPage","setCurrentPage","paginationData","items","pageNumber","pageSize","startIndex","_","slice","take","value","paginate","totalCount","length","data","getPageData","handlePageChange","page","Pagination","props","itemsCount","onPageChange","pageCount","Math","ceil","pages","range","className","style","marginTop","map","href","onClick","BookItem","book","url","setUrl","isLoading","setIsLoading","avatarUrl","setAvatarUrl","date","dayjs","createdOn","format","useEffect","getImageUrl","_id","then","x","getAvatar","creator","description","Card","styles","Image","src","alt","marginLeft","Body","Img","width","height","Title","textDecoration","fontSize","to","color","title","Text","likes","wordBreak","Link","as","BooksList","splittedData","arr","len","chunks","i","n","push","splitArray","searchByTitle","string","a","getAll","results","toLowerCase","includes","sort","b","localeCompare","searchByAuthor","author","searchByGenre","genres","filter","searchBySeries","series","seriesRow","isAuth","Component","useSelector","state","user","token","db","getDatabase","app","dbRef","ref","getUserFavourites","get","child","userKey","snapshot","users","val","favourites","localStorage","getItem","userId","id","getBook","undefined","splice","indexOf","set","getCreatedBooks","created","getLikedBooks","liked","setUserPreferences","authors","preferences","getUserPreferences","getRecommendedBooks","allBooks","recommendedBooks","genre","Set","Array","from","removeProfile","usersSnap","getAllComments","comments","removeBook","edit","removeAllCommentsForBook","comment","removeComment","remove","setFavourites","setBooks","isFetch","setIsFetch"],"mappings":"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","file":"static/js/14.8b6588b8.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"card\":\"BookItem_card__3WB3x\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"books-row\":\"BooksList_books-row__2-grT\"};","import { useState } from \"react\"\r\nimport { paginate } from \"../components/books/utils/Pagination/paginate\"\r\n\r\nexport default function usePaginate(books) {\r\n    const [currentPage, setCurrentPage] = useState(1)\r\n    const pageSize = 9\r\n\r\n    const handlePageChange = page => {\r\n        setCurrentPage(page)\r\n    }\r\n\r\n    const getPageData = () => {\r\n\r\n        const paginationData = paginate(books, currentPage, pageSize)\r\n        return { totalCount: books.length, data: paginationData }\r\n    }\r\n\r\n    const { totalCount, data } = getPageData()\r\n    return { data, totalCount, pageSize, currentPage, handlePageChange }\r\n\r\n}","import _ from 'lodash'\r\n\r\nexport function paginate(items, pageNumber, pageSize){\r\n   const startIndex = (pageNumber - 1) * pageSize\r\n\r\n   return _(items)\r\n            .slice(startIndex)\r\n            .take(pageSize)\r\n            .value()\r\n}","import React from 'react'\r\nimport _ from 'lodash'\r\nimport './pagination.css'\r\n\r\nconst Pagination = (props) => {\r\n\r\n    const { itemsCount, pageSize, currentPage, onPageChange } = props\r\n    const pageCount = Math.ceil(itemsCount / pageSize)\r\n    if (pageCount === 1) return null\r\n    const pages = _.range(1, pageCount + 1)\r\n\r\n    return (\r\n        <div className=\"pagination\" style={{ marginTop: \"5%\" }}>\r\n            {pages.map(page => (\r\n                <div href={null} key={page}\r\n                    onClick={() => onPageChange(page)}\r\n                    className={page === currentPage ? 'active' : 'page-item'}>\r\n                    {page}\r\n                </div>\r\n            ))}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Pagination","import { useEffect, useState } from 'react'\r\nimport Card from 'react-bootstrap/Card'\r\nimport Image from 'react-bootstrap/Image'\r\nimport * as dayjs from 'dayjs'\r\nimport { Link } from \"react-router-dom\"\r\nimport { getAvatar, getImageUrl } from '../../../../../services/image-service'\r\nimport styles from './BookItem.module.css'\r\n\r\nexport default function BookItem({ book }) {\r\n    const [url, setUrl] = useState('')\r\n    const [isLoading, setIsLoading] = useState(true)\r\n    const [avatarUrl, setAvatarUrl] = useState('')\r\n    const date = dayjs(book.createdOn).format('DD/MM/YYYY h:mm A')\r\n\r\n    useEffect(() => {\r\n        if (isLoading) {\r\n            getImageUrl(book._id).then(x => {\r\n                setUrl(x)\r\n            })\r\n            getAvatar(book.creator).then(x => {\r\n                setAvatarUrl(x)\r\n            })\r\n        }\r\n\r\n        if (avatarUrl === '') {\r\n            setAvatarUrl('https://media.istockphoto.com/illustrations/blank-man-profile-head-icon-placeholder-illustration-id1298261537?k=20&m=1298261537&s=612x612&w=0&h=8plXnK6Ur3LGqG9s-Xt2ZZfKk6bI0IbzDZrNH9tr9Ok=')\r\n        }\r\n\r\n        return () => {\r\n            setIsLoading(false)\r\n        }\r\n    }, [isLoading, book._id, book.creator, avatarUrl])\r\n\r\n\r\n    if (book.description.length > 255) {\r\n        book.description = book.description.slice(0, 256)\r\n        book.description += '...'\r\n    }\r\n\r\n    return <Card className={styles['card']}>\r\n        <Image src={avatarUrl} alt=\"No avatar\" className=\"avatar\" style={{ marginLeft: \"36%\", marginTop: \"5%\" }} />\r\n        <Card.Body>\r\n            <Card.Img src={url} style={{ width: '60%', height: \"40%\" }} alt=\"No image\" />\r\n            <Card.Title style={{ marginTop: \"5%\", textDecoration: \"underline\", fontSize: \"20px\" }}><Link to={`/details/${book._id}`} style={{ color: \"grey\" }}>{book.title}</Link></Card.Title>\r\n            <Card.Text style={{ fontSize: \"12px\" }}>Book added on {date} <Link to={`/user/${book.creator}`} style={{ fontSize: \"12px\", color: \"black\" }}> by {book.creator}</Link></Card.Text>\r\n            {book.likes\r\n                ? <Card.Text style={{ fontSize: \"12px\" }}>{book.likes.length} like{book.likes.length > 1 ? 's' : ''}</Card.Text>\r\n                : <Card.Text style={{ fontSize: \"12px\" }}>0 likes</Card.Text>\r\n            }\r\n            <Card.Text style={{ wordBreak: 'break-all', fontSize: \"15px\" }}>\r\n                {book.description}\r\n            </Card.Text>\r\n            <Card.Link as={Link} to={`/details/${book._id}`} style={{ color: 'grey', textDecoration: 'none', fontSize: \"15px\" }}>See more...</Card.Link>\r\n        </Card.Body>\r\n    </Card>\r\n}","import usePaginate from \"../../../../hooks/usePaginate\"\r\nimport Pagination from \"../Pagination/Pagination\"\r\nimport BookItem from \"./BookItem/BookItem\"\r\nimport splitArray from \"../../../util/splitArray\"\r\nimport styles from './BooksList.module.css'\r\n\r\n\r\nexport default function BooksList({ books }) {\r\n    const { data, totalCount, pageSize, currentPage, handlePageChange } = usePaginate(books ? books : [])\r\n    const splittedData = splitArray(data, 3)\r\n\r\n    return <>\r\n        {splittedData.map(x => {\r\n            return <div className={styles['books-row']} data-testid=\"booksrow\" key={x[0]._id}>\r\n                {x.map(book => {\r\n                    return <BookItem book={book} key={book._id} />\r\n                })\r\n                }\r\n            </div>\r\n        })}\r\n        <Pagination\r\n            itemsCount={totalCount}\r\n            pageSize={pageSize}\r\n            currentPage={currentPage}\r\n            onPageChange={handlePageChange} />\r\n    </>\r\n}","export default function splitArray(arr, len) {\r\n    var chunks = [], i = 0, n = arr.length;\r\n    while (i < n) {\r\n        chunks.push(arr.slice(i, i += len));\r\n    }\r\n    return chunks;\r\n}","import { getAll } from './books-service'\r\n\r\nexport async function searchByTitle(string) {\r\n    const books = await getAll()\r\n    const results = []\r\n    if (books !== null) {\r\n        for (const book of books) {\r\n            if (book.title.toLowerCase().includes(string.toLowerCase())) {\r\n                results.push(book)\r\n            }\r\n        }\r\n        results.sort((a, b) => a.title.localeCompare(b.title))\r\n    }\r\n    return results\r\n}\r\n\r\nexport async function searchByAuthor(string) {\r\n    const books = await getAll()\r\n    const results = []\r\n    if (books !== null) {\r\n        for (const book of books) {\r\n            if (book.author.toLowerCase().includes(string.toLowerCase())) {\r\n                results.push(book)\r\n            }\r\n        }\r\n        results.sort((a, b) => a.title.localeCompare(b.title))\r\n    }\r\n    return results\r\n}\r\n\r\nexport async function searchByGenre(string) {\r\n    const books = await getAll()\r\n    const results = []\r\n    if (books !== null) {\r\n        for (const book of books) {\r\n            const genres = book.genres.map(x => x.toLowerCase())\r\n            if (genres.filter(x => x.includes(string.toLowerCase())).length > 0) {\r\n                results.push(book)\r\n            }\r\n        }\r\n        results.sort((a, b) => a.title.localeCompare(b.title))\r\n    }\r\n    return results\r\n}\r\n\r\nexport async function searchBySeries(string) {\r\n    const books = await getAll()\r\n    const results = []\r\n    if (books !== null) {\r\n        for (const book of books) {\r\n            if (book.series && book.series.toLowerCase().includes(string.toLowerCase())) {\r\n                results.push(book)\r\n            }\r\n        }\r\n        results.sort((a, b) => a.seriesRow - b.seriesRow)\r\n    }\r\n    return results\r\n}","import { useSelector } from 'react-redux'\r\nimport { Navigate } from 'react-router-dom'\r\n\r\nexport const isAuth = (Component) => {\r\n\r\n    const WrapperComponent = (props) => {\r\n        const user = useSelector((state) => state.user)\r\n\r\n        return user.token !== null\r\n            ? <Component {...props} />\r\n            : <Navigate to=\"/login\" />\r\n    }\r\n\r\n    return WrapperComponent\r\n}\r\n","import { getDatabase, ref, child, get, set, remove } from \"firebase/database\"\r\nimport app from './firebase'\r\nimport { getAll, getBook, removeBook, edit } from './books-service'\r\nimport { searchByGenre,searchByAuthor } from './search-service'\r\nimport { getAllComments, removeAllCommentsForBook, removeComment } from \"./comments-service\"\r\n\r\nconst db = getDatabase(app)\r\nconst dbRef = ref(db)\r\n\r\nexport async function getUserFavourites() {\r\n    const snapshot = await get(child(dbRef, '/users'))\r\n    const users = snapshot.val()\r\n    let userId\r\n    let favourites = []\r\n    for (let userKey in users) {\r\n        if (users[userKey]._id === localStorage.getItem('token')) {\r\n            const user = users[userKey]\r\n            userId = userKey\r\n            if (user.favourites) {\r\n                favourites = user.favourites\r\n            }\r\n        }\r\n    }\r\n    for (let id of favourites) {\r\n        const book = await getBook(id)\r\n        if (book === undefined) {\r\n            favourites.splice(favourites.indexOf(id), 1)\r\n        }\r\n        const user = users[userId]\r\n        user.favourites = favourites\r\n        await set(child(dbRef, '/users/' + userId), user)\r\n    }\r\n    return favourites\r\n}\r\n\r\nexport async function getCreatedBooks() {\r\n    const books = await getAll()\r\n    let created = []\r\n    if (books !== null) {\r\n        for (let book of books) {\r\n            if (book.creator === localStorage.getItem('username')) {\r\n                created.push(book)\r\n            }\r\n        }\r\n    }\r\n    return created\r\n}\r\n\r\nexport async function getLikedBooks() {\r\n    const books = await getAll()\r\n    let liked = []\r\n    if (books !== null) {\r\n        for (let book of books) {\r\n            if (book.likes !== undefined && book.likes.includes(localStorage.getItem('username'))) {\r\n                liked.push(book)\r\n            }\r\n        }\r\n    }\r\n    return liked\r\n}\r\n\r\nexport async function setUserPreferences({ authors, genres }) {\r\n    const snapshot = await get(child(dbRef, '/users'))\r\n    const users = snapshot.val()\r\n    for (let userKey in users) {\r\n        if (users[userKey]._id === localStorage.getItem('token')) {\r\n            const user = users[userKey]\r\n            user.preferences = { authors, genres }\r\n            await set(child(dbRef, '/users/' + userKey), user)\r\n        }\r\n    }\r\n}\r\n\r\nexport async function getUserPreferences() {\r\n    const snapshot = await get(child(dbRef, '/users'))\r\n    const users = snapshot.val()\r\n    let preferences = {}\r\n    for (let userKey in users) {\r\n        if (users[userKey]._id === localStorage.getItem('token')) {\r\n            const user = users[userKey]\r\n            if (user.preferences) {\r\n                preferences = user.preferences\r\n            } else {\r\n                preferences = { authors: [], genres: [] }\r\n            }\r\n        }\r\n    }\r\n    return preferences\r\n}\r\n\r\nexport async function getRecommendedBooks() {\r\n    const { genres, authors } = await getUserPreferences()\r\n    const allBooks = await getAll()\r\n    const recommendedBooks = []\r\n\r\n    if (allBooks !== null) {\r\n        if (genres && genres.length > 0) {\r\n            for (let genre of genres) {\r\n                const filteredBooks = await searchByGenre(genre)\r\n                filteredBooks.map(x => {\r\n                    recommendedBooks.push(x)\r\n                    return x\r\n                })\r\n            }\r\n        }\r\n        if (authors && authors.length > 0) {\r\n            for (let author of authors) {\r\n                const filteredBooks = await searchByAuthor(author)\r\n                filteredBooks.map(x => {\r\n                    recommendedBooks.push(x)\r\n                    return x\r\n                })\r\n            }\r\n        }\r\n    }\r\n    const set = new Set(recommendedBooks)\r\n    return Array.from(set)\r\n}\r\n\r\nexport async function removeProfile() {\r\n    const books = await getAll()\r\n    const usersSnap = await get(dbRef, '/users')\r\n    const users = usersSnap.val()\r\n    const comments = await getAllComments()\r\n    for (const book of books) {\r\n        if (book.creator === localStorage.getItem('username')) {\r\n            await removeBook(book._id)\r\n        }\r\n        if (book.likes && book.likes.includes(localStorage.getItem('username'))) {\r\n            book.likes.splice(book.likes.indexOf(localStorage.getItem('username')), 1)\r\n            await edit(book._id, book)\r\n        }\r\n        await removeAllCommentsForBook(book._id)\r\n    }\r\n\r\n    for (const comment of comments) {\r\n        if (comment.creator === localStorage.getItem('username')) {\r\n            await removeComment(comment._id)\r\n        }\r\n    }\r\n\r\n    for (const userId in users) {\r\n        const user = users[userId]\r\n        if (user._id === localStorage.getItem('token')) {\r\n            await remove(child(dbRef, '/users/' + userId))\r\n        }\r\n    }\r\n\r\n}","import { useState, useEffect } from \"react\"\r\n\r\nimport BooksList from '../../utils/BooksList/BooksList'\r\nimport { getUserFavourites } from \"../../../../services/profile-service\"\r\nimport { getBook } from \"../../../../services/books-service\"\r\nimport { isAuth } from '../../../../hoc/isAuth'\r\n\r\nfunction FavouriteBooks() {\r\n    const [favourites, setFavourites] = useState([])\r\n    const [books, setBooks] = useState([])\r\n    const [isFetch, setIsFetch] = useState(true)\r\n\r\n    useEffect(() => {\r\n        if (isFetch) {\r\n            getUserFavourites().then(x => {\r\n                x.map(id => {\r\n                    getBook(id).then(x => {\r\n                        setBooks([...books, x])\r\n                    })\r\n                    return null\r\n                })\r\n                setFavourites(x)\r\n            })\r\n        }\r\n\r\n        return () => {\r\n            setIsFetch(false)\r\n        }\r\n    })\r\n\r\n    return !isFetch\r\n        ? favourites && favourites.length > 0\r\n            ? <>\r\n                <h1 style={{ marginTop:\"0.5%\" }}>Favoruite books</h1>\r\n                <BooksList books={books} />\r\n            </>\r\n            : <p>No favourite books</p>\r\n        : <p>Loading books...</p>\r\n}\r\n\r\nexport default isAuth(FavouriteBooks)"],"sourceRoot":""}